import React, { useContext } from "react";
import Box from "@mui/material/Box";
import Stepper from "@mui/material/Stepper";
import Step from "@mui/material/Step";
import StepLabel from "@mui/material/StepLabel";
import StepConnector, {
  stepConnectorClasses,
} from "@mui/material/StepConnector";
import { styled } from "@mui/material/styles";
import { Data } from "../Context/Store";
import stepper_bg from "../assets/sidebar_bg.svg";

const steps = [
  { id: 1, label: "Teaching Performance", value: "Teaching" },
  { id: 2, label: "Research Performance", value: "Research" },
  { id: 3, label: "Service Performance", value: "Service" },
];

const stepIndexMap = {
  Teaching: 0,
  Research: 1,
  Service: 2,
};

const iconMap = {
  1: (
    <svg
      width="32"
      height="24"
      viewBox="0 0 32 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M15 4V24C14 23 12 21 7.5 21C5.40175 20.9889 3.3149 21.3091 1.3165 21.9487C1.16616 21.9989 1.00605 22.0126 0.849365 21.9887C0.692684 21.9649 0.543922 21.9041 0.415342 21.8114C0.286763 21.7188 0.18205 21.5969 0.109836 21.4558C0.0376215 21.3147 -2.49469e-05 21.1585 1.42409e-08 21V3C-2.3289e-05 2.86191 0.028553 2.72531 0.0839285 2.59882C0.139304 2.47232 0.220278 2.35866 0.32175 2.265C1.72125 0.974 4.807 0 7.5 0C11.186 0 13.3285 2.004 14.48 3.08025L14.6783 3.26525C14.7797 3.35888 14.8606 3.4725 14.916 3.59895C14.9714 3.72541 15 3.86195 15 4ZM17 4V24C18 23 20 21 24.5 21C26.5982 20.9889 28.6851 21.3091 30.6835 21.9487C30.8338 21.999 30.994 22.0128 31.1507 21.989C31.3074 21.9652 31.4563 21.9044 31.5849 21.8117C31.7135 21.719 31.8182 21.5971 31.8904 21.456C31.9626 21.3148 32.0001 21.1585 32 21V3C32 2.86191 31.9714 2.72531 31.9161 2.59882C31.8607 2.47232 31.7797 2.35866 31.6782 2.265C30.2787 0.97425 27.1933 0 24.5 0C20.8145 0 18.6713 2.004 17.52 3.08025C17.4508 3.14525 17.3853 3.20675 17.3218 3.26525C17.2203 3.35888 17.1394 3.4725 17.084 3.59895C17.0286 3.72541 17 3.86195 17 4Z"
        fill="#318179"
      />
    </svg>
  ),

  2: (
    <svg
      width="33"
      height="32"
      viewBox="0 0 33 32"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M16.27 12C16.27 12.3978 16.4281 12.7794 16.7094 13.0607C16.9907 13.342 17.3722 13.5 17.77 13.5H19.27V10.5H17.77C17.3722 10.5 16.9907 10.658 16.7094 10.9393C16.4281 11.2206 16.27 11.6022 16.27 12ZM22.77 10.5H21.27V13.5H22.77C23.1678 13.5 23.5494 13.342 23.8307 13.0607C24.112 12.7794 24.27 12.3978 24.27 12C24.27 11.6022 24.112 11.2206 23.8307 10.9393C23.5494 10.658 23.1678 10.5 22.77 10.5Z"
        fill="white"
      />
      <path
        d="M20.2698 0.99996C18.1867 1.00663 16.1484 1.60466 14.3918 2.72446C12.6353 3.84426 11.2329 5.4398 10.3477 7.32546C9.46245 9.21112 9.13087 11.3094 9.39148 13.3761C9.6521 15.4428 10.4942 17.3931 11.8198 19L9.92982 20.9L11.3398 22.31L13.2698 20.45C14.6284 21.5823 16.2401 22.3703 17.968 22.7472C19.696 23.1241 21.4894 23.0788 23.1962 22.6151C24.9029 22.1514 26.4727 21.2831 27.7724 20.0836C29.0721 18.8841 30.0635 17.389 30.6624 15.7248C31.2613 14.0607 31.4501 12.2767 31.2128 10.5241C30.9756 8.7715 30.3192 7.10193 29.2993 5.65697C28.2795 4.212 26.9263 3.03425 25.3544 2.22355C23.7826 1.41286 22.0384 0.993134 20.2698 0.99996ZM22.7698 15.5H17.7698C16.8416 15.5 15.9513 15.1312 15.2949 14.4748C14.6386 13.8185 14.2698 12.9282 14.2698 12C14.2698 11.0717 14.6386 10.1815 15.2949 9.52509C15.9513 8.86871 16.8416 8.49996 17.7698 8.49996H22.7698C23.6981 8.49996 24.5883 8.86871 25.2447 9.52509C25.9011 10.1815 26.2698 11.0717 26.2698 12C26.2698 12.9282 25.9011 13.8185 25.2447 14.4748C24.5883 15.1312 23.6981 15.5 22.7698 15.5ZM2.14982 25.88C1.58802 26.4425 1.27246 27.205 1.27246 28C1.27246 28.795 1.58802 29.5575 2.14982 30.12C2.71232 30.6818 3.47482 30.9973 4.26982 30.9973C5.06482 30.9973 5.82732 30.6818 6.38982 30.12L11.3898 25.17L7.09982 20.93L2.14982 25.88Z"
        fill="white"
      />
    </svg>
  ),
  3: (
    <svg
      width="33"
      height="32"
      viewBox="0 0 33 32"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g clip-path="url(#clip0_176_273)">
        <path
          d="M31.9191 20.2688C31.1381 19.8069 30.1602 19.7322 29.2874 20.1193C29.2874 20.1193 29.284 20.1228 29.2704 20.1261C29.267 20.1295 29.2602 20.1295 29.2568 20.1329C29.2602 20.1329 29.2568 20.1329 29.2466 20.1363L29.2398 20.1397L29.2364 20.1431C29.2228 20.1464 29.2092 20.1532 29.1923 20.1601C28.8731 20.3026 27.6268 20.8562 23.389 22.7306V22.7238C22.4382 21.3757 20.7642 22.3706 18.4958 22.5676C14.9779 20.7645 11.6569 18.9987 8.01334 19.1107V26.3266H8.61778L16.1834 29.3149C17.4195 29.8038 18.8218 29.6782 19.956 28.9821L31.9258 21.5965C32.4182 21.2909 32.4217 20.5642 31.9191 20.2688ZM6.62659 18.2222H6.01934V17.7679C6.01934 17.4129 5.73159 17.1251 5.37653 17.1251H1.01928C0.664215 17.1251 0.376465 17.4129 0.376465 17.7679V28.0643C0.376465 28.4194 0.664215 28.7071 1.01928 28.7071H5.37653C5.73159 28.7071 6.01934 28.4194 6.01934 28.0643V27.6101H6.62659C7.01803 27.6101 7.33534 27.2927 7.33534 26.9012V18.931C7.3354 18.5396 7.01803 18.2222 6.62659 18.2222ZM4.05296 27.7212C3.61609 27.7212 3.25821 27.3634 3.25821 26.9265C3.25821 26.4897 3.61609 26.1318 4.05296 26.1318C4.48978 26.1318 4.84765 26.4897 4.84765 26.9265C4.84765 27.3634 4.48978 27.7212 4.05296 27.7212Z"
          fill="white"
        />
        <path
          d="M12.4292 12.2143L13.7871 12.3704C13.95 13.0765 14.2283 13.7554 14.6153 14.3665L13.7599 15.4392C13.5359 15.7243 13.563 16.1249 13.8142 16.3761L14.7511 17.3129C15.0022 17.5641 15.4028 17.5913 15.6879 17.3673L16.7606 16.5119C17.3716 16.8989 18.0505 17.1772 18.7566 17.3401L18.9127 18.6979C19.0191 19.6378 20.2528 19.2319 20.9291 19.3225C21.2889 19.3225 21.5877 19.0577 21.6284 18.6979L21.7846 17.3401C22.4907 17.1772 23.1696 16.8988 23.7806 16.5118L24.8532 17.3673C25.1384 17.5913 25.5389 17.5641 25.7901 17.3129L26.727 16.3761C26.9782 16.1249 27.0054 15.7243 26.7814 15.4391L25.9259 14.3664C26.3129 13.7554 26.5913 13.0766 26.7542 12.3705L28.112 12.2143C28.4718 12.1736 28.7366 11.8749 28.7366 11.515V10.1979C28.7366 9.83813 28.4718 9.53944 28.112 9.49863L26.7542 9.34244C26.5913 8.63644 26.3129 7.95744 25.9259 7.3465L26.7814 6.27382C27.0054 5.98869 26.9783 5.58813 26.727 5.33694L25.7901 4.40007C25.5389 4.14888 25.1384 4.12169 24.8532 4.34575L23.7806 5.20113C23.1696 4.81413 22.4907 4.53582 21.7846 4.37294L21.6284 3.01507C21.5877 2.65519 21.289 2.3905 20.9291 2.3905H19.6121C19.2523 2.3905 18.9535 2.65532 18.9127 3.01507L18.7566 4.37294C18.0505 4.53582 17.3716 4.81413 16.7606 5.20113L15.6879 4.34575C15.4028 4.12175 15.0022 4.14894 14.7511 4.40013L13.8142 5.337C13.563 5.58819 13.5359 5.98869 13.7599 6.27388L14.6153 7.3465C14.2283 7.95757 13.95 8.63644 13.7871 9.34257L12.4292 9.49875C12.0694 9.53944 11.8047 9.83825 11.8047 10.1981V11.5151C11.8047 11.8749 12.0694 12.1736 12.4292 12.2143ZM18.0859 8.67863C19.2922 7.47231 21.2434 7.47231 22.4497 8.67863C23.6479 9.87681 23.6479 11.8361 22.4497 13.0343C21.2434 14.2406 19.2922 14.2406 18.0859 13.0343C16.8796 11.8361 16.8796 9.87681 18.0859 8.67863Z"
          fill="white"
        />
      </g>
      <defs>
        <clipPath id="clip0_176_273">
          <rect
            width="32"
            height="32"
            fill="white"
            transform="translate(0.335938)"
          />
        </clipPath>
      </defs>
    </svg>
  ),
};
const inActiveIcon = {
  1: (
    <svg
      width="32"
      height="24"
      viewBox="0 0 32 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M15 4V24C14 23 12 21 7.5 21C5.40175 20.9889 3.3149 21.3091 1.3165 21.9487C1.16616 21.9989 1.00605 22.0126 0.849365 21.9887C0.692684 21.9649 0.543922 21.9041 0.415342 21.8114C0.286763 21.7188 0.18205 21.5969 0.109836 21.4558C0.0376215 21.3147 -2.49469e-05 21.1585 1.42409e-08 21V3C-2.3289e-05 2.86191 0.028553 2.72531 0.0839285 2.59882C0.139304 2.47232 0.220278 2.35866 0.32175 2.265C1.72125 0.974 4.807 0 7.5 0C11.186 0 13.3285 2.004 14.48 3.08025L14.6783 3.26525C14.7797 3.35888 14.8606 3.4725 14.916 3.59895C14.9714 3.72541 15 3.86195 15 4ZM17 4V24C18 23 20 21 24.5 21C26.5982 20.9889 28.6851 21.3091 30.6835 21.9487C30.8338 21.999 30.994 22.0128 31.1507 21.989C31.3074 21.9652 31.4563 21.9044 31.5849 21.8117C31.7135 21.719 31.8182 21.5971 31.8904 21.456C31.9626 21.3148 32.0001 21.1585 32 21V3C32 2.86191 31.9714 2.72531 31.9161 2.59882C31.8607 2.47232 31.7797 2.35866 31.6782 2.265C30.2787 0.97425 27.1933 0 24.5 0C20.8145 0 18.6713 2.004 17.52 3.08025C17.4508 3.14525 17.3853 3.20675 17.3218 3.26525C17.2203 3.35888 17.1394 3.4725 17.084 3.59895C17.0286 3.72541 17 3.86195 17 4Z"
        fill="#318179"
      />
    </svg>
  ),
  2: (
    <svg
      width="31"
      height="30"
      viewBox="0 0 31 30"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M19 8.19293e-05C16.917 0.00675444 14.8786 0.604779 13.1221 1.72458C11.3655 2.84438 9.9631 4.43993 9.07789 6.32558C8.19268 8.21124 7.86109 10.3095 8.12171 12.3762C8.38232 14.443 9.22443 16.3932 10.55 18.0001L8.66005 19.9001L10.07 21.3101L12 19.4501C13.3587 20.5824 14.9703 21.3704 16.6983 21.7473C18.4263 22.1242 20.2196 22.0789 21.9264 21.6152C23.6331 21.1516 25.2029 20.2832 26.5026 19.0837C27.8023 17.8843 28.7937 16.3891 29.3926 14.725C29.9915 13.0609 30.1803 11.2769 29.9431 9.52424C29.7058 7.77162 29.0494 6.10206 28.0296 4.65709C27.0097 3.21213 25.6565 2.03437 24.0847 1.22368C22.5128 0.412983 20.7686 -0.00674345 19 8.19293e-05ZM21.5 14.5001H16.5C15.5718 14.5001 14.6815 14.1313 14.0252 13.475C13.3688 12.8186 13 11.9283 13 11.0001C13 10.0718 13.3688 9.18159 14.0252 8.52521C14.6815 7.86883 15.5718 7.50008 16.5 7.50008H21.5C22.4283 7.50008 23.3185 7.86883 23.9749 8.52521C24.6313 9.18159 25 10.0718 25 11.0001C25 11.9283 24.6313 12.8186 23.9749 13.475C23.3185 14.1313 22.4283 14.5001 21.5 14.5001ZM0.880046 24.8801C0.318244 25.4426 0.00268555 26.2051 0.00268555 27.0001C0.00268555 27.7951 0.318244 28.5576 0.880046 29.1201C1.44255 29.6819 2.20504 29.9974 3.00005 29.9974C3.79505 29.9974 4.55754 29.6819 5.12005 29.1201L10.12 24.1701L5.83005 19.9301L0.880046 24.8801Z"
        fill="#222222"
      />
    </svg>
  ),
  3: (
    <svg
      width="33"
      height="32"
      viewBox="0 0 33 32"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g clip-path="url(#clip0_176_273)">
        <path
          d="M31.6488 20.2689C30.8678 19.8071 29.8899 19.7324 29.0171 20.1194C29.0171 20.1194 29.0138 20.1229 29.0001 20.1262C28.9968 20.1296 28.99 20.1296 28.9865 20.1331C28.9899 20.1331 28.9865 20.1331 28.9763 20.1364L28.9695 20.1398L28.9661 20.1432C28.9526 20.1466 28.939 20.1534 28.922 20.1602C28.6028 20.3027 27.3566 20.8563 23.1188 22.7307V22.7239C22.1679 21.3759 20.4939 22.3707 18.2256 22.5677C14.7076 20.7646 11.3866 18.9989 7.74308 19.1109V26.3267H8.34751L15.9131 29.315C17.1492 29.8039 18.5516 29.6784 19.6858 28.9822L31.6556 21.5966C32.148 21.291 32.1514 20.5643 31.6488 20.2689ZM6.35633 18.2223H5.74908V17.7681C5.74908 17.413 5.46133 17.1252 5.10626 17.1252H0.749014C0.393951 17.1252 0.106201 17.413 0.106201 17.7681V28.0644C0.106201 28.4195 0.393951 28.7072 0.749014 28.7072H5.10626C5.46133 28.7072 5.74908 28.4195 5.74908 28.0644V27.6102H6.35633C6.74776 27.6102 7.06508 27.2928 7.06508 26.9014V18.9311C7.06514 18.5397 6.74776 18.2223 6.35633 18.2223ZM3.7827 27.7213C3.34583 27.7213 2.98795 27.3635 2.98795 26.9266C2.98795 26.4898 3.34583 26.1319 3.7827 26.1319C4.21951 26.1319 4.57739 26.4898 4.57739 26.9266C4.57739 27.3635 4.21951 27.7213 3.7827 27.7213Z"
          fill="#222222"
        />
        <path
          d="M12.1592 12.2144L13.517 12.3706C13.68 13.0766 13.9583 13.7556 14.3453 14.3666L13.4899 15.4393C13.2659 15.7244 13.293 16.125 13.5442 16.3762L14.481 17.3131C14.7322 17.5642 15.1328 17.5914 15.4179 17.3674L16.4906 16.512C17.1016 16.899 17.7805 17.1773 18.4866 17.3402L18.6427 18.6981C18.7491 19.6379 19.9828 19.2321 20.6591 19.3226C21.0189 19.3226 21.3177 19.0578 21.3584 18.6981L21.5145 17.3402C22.2207 17.1773 22.8995 16.8989 23.5105 16.5119L24.5832 17.3674C24.8684 17.5914 25.2689 17.5642 25.5201 17.3131L26.457 16.3762C26.7082 16.125 26.7354 15.7244 26.5114 15.4392L25.6559 14.3666C26.0429 13.7556 26.3212 13.0767 26.4842 12.3706L27.842 12.2144C28.2018 12.1737 28.4665 11.8751 28.4665 11.5151V10.1981C28.4665 9.83825 28.2018 9.53956 27.842 9.49875L26.4842 9.34256C26.3212 8.63656 26.0429 7.95756 25.6559 7.34662L26.5114 6.27394C26.7354 5.98881 26.7082 5.58825 26.457 5.33706L25.5201 4.40019C25.2689 4.149 24.8684 4.12181 24.5832 4.34587L23.5105 5.20125C22.8995 4.81425 22.2207 4.53594 21.5145 4.37306L21.3584 3.01519C21.3177 2.65531 21.019 2.39062 20.6591 2.39062H19.342C18.9822 2.39062 18.6835 2.65544 18.6427 3.01519L18.4866 4.37306C17.7805 4.53594 17.1016 4.81425 16.4906 5.20125L15.4179 4.34587C15.1328 4.12187 14.7322 4.14906 14.481 4.40025L13.5442 5.33712C13.293 5.58831 13.2659 5.98881 13.4899 6.274L14.3453 7.34662C13.9583 7.95769 13.68 8.63656 13.517 9.34269L12.1592 9.49888C11.7994 9.53956 11.5347 9.83838 11.5347 10.1982V11.5152C11.5347 11.8751 11.7994 12.1737 12.1592 12.2144ZM17.8159 8.67875C19.0222 7.47244 20.9734 7.47244 22.1797 8.67875C23.3779 9.87694 23.3779 11.8362 22.1797 13.0344C20.9734 14.2407 19.0222 14.2407 17.8159 13.0344C16.6095 11.8362 16.6095 9.87694 17.8159 8.67875Z"
          fill="#222222"
        />
      </g>
      <defs>
        <clipPath id="clip0_176_273">
          <rect
            width="32"
            height="32"
            fill="white"
            transform="translate(0.0656738)"
          />
        </clipPath>
      </defs>
    </svg>
  ),
};

// ✅ Custom dotted connector
const CustomConnector = styled(StepConnector)(({ theme }) => ({
  [`&.${stepConnectorClasses.vertical}`]: {
    marginLeft: 0, // remove default spacing
  },
  [`& .${stepConnectorClasses.line}`]: {
    marginLeft: 16, // align exactly with the icon center (width/2 of 32px circle)
    // borderLeftStyle: 'dotted',
    borderLeftWidth: 2,
    minHeight: 86,
  },
}));

// ✅ Custom step icon component
const CustomStepIcon = (props) => {
  const { active, icon } = props;

  const iconNumber = Number(icon); // Ensure icon is treated as a number (icon could be a string like "1")

  return (
    <div
      className={`flex items-center justify-center w-11 h-11 border rounded-full  p-2
            ${
              active
                ? "border-white bg-white "
                : "border-white border-2 border-dashed"
            }`}
    >
      {/* {active ? iconMap[iconNumber] : inActiveIcon[iconNumber]} */}
      {active ? iconMap[iconNumber] : iconMap[iconNumber]}
    </div>
  );
};

const VerticalStepper = () => {
  const { selectedTab } = useContext(Data);

  return (
    <div className="img-container h-[93vh] relative">
      <img src={stepper_bg} className="h-[100%] object-cover rounded-xl" />
      <div className="main-container  p-4 h-[100%] absolute top-0 rounded-xl">
        <div className="header mb-4">
          <h1 className="text-[26px] text-white font-semibold login-heading">
            Step <span>{stepIndexMap[selectedTab] + 1}</span>
          </h1>
          <p className="text-[#f5f5f5] text-sm mt-2">
            Lorem Ipsum is simply dummy text of the printing and typesetting
            industry
          </p>
        </div>
        <Box sx={{ width: "100%", marginTop: "40px" }}>
          <Stepper
            activeStep={stepIndexMap[selectedTab]}
            orientation="vertical"
            connector={<CustomConnector />}
          >
            {steps.map((step, index) => {
              const isActive = stepIndexMap[selectedTab] === index;

              return (
                <Step key={step.id}>
                  <StepLabel
                    StepIconComponent={CustomStepIcon}
                    sx={{
                      ".MuiStepLabel-label": {
                        fontSize: "1.25rem",
                        color: "white !important",
                      },
                      ".MuiStepLabel-label.Mui-active": {
                        color: "white !important",
                      },
                      ".MuiStepLabel-label.Mui-completed": {
                        color: "white !important",
                      },
                      ".MuiStepLabel-label.Mui-disabled": {
                        color: "white !important",
                      },
                    }}
                  >
                    {step.label}
                  </StepLabel>
                </Step>
              );
            })}
          </Stepper>
        </Box>
      </div>
    </div>
  );
};

export default VerticalStepper;
